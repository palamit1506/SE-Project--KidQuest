openapi: 3.0.3

info:
  title: KidQuest API
  version: 1.0.0
  description: |
    KidQuest is a comprehensive child development platform that provides educational tools, 
    emotional support, health tracking, financial literacy, and parent-teacher collaboration features.
    
    **Authentication**: Most endpoints require session-based authentication. Use the login endpoint 
    to obtain session credentials.
    
    **User Roles**: 
    - child: Young users accessing educational content
    - parent: Guardians monitoring child progress
    - teacher: Educators managing classroom activities
    - admin: System administrators
  contact:
    email: support@kidquest.com
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT

servers:
  - url: http://localhost:5000
    description: Development server
  - url: https://api.kidquest.com
    description: Production server

components:
    
  schemas:
    User:
      type: object
      properties:
        id:
          type: integer
          description: Unique user identifier
        username:
          type: string
          description: User's chosen username
        email:
          type: string
          format: email
          description: User's email address
        role:
          type: string
          enum: [child, parent, teacher, admin]
          description: User's role in the system
      required:
        - id
        - username
        - role

    RegisterRequest:
      type: object
      properties:
        username:
          type: string
          minLength: 3
          maxLength: 50
          description: Desired username
        password:
          type: string
          minLength: 6
          description: User password
        email:
          type: string
          format: email
          description: User email address
        role:
          type: string
          enum: [child, parent, teacher]
          description: User role
        relationship_type:
          type: string
          enum: [Mother, Father, Guardian]
          description: Required for parent registration
        child_username:
          type: string
          description: Child's username (for parent registration)
        className:
          type: string
          description: Class name (for teacher registration)
        primarySubject:
          type: string
          enum: [Mathematics, Science, English, Social Studies, Art, Physical Education, Computer Science, General Studies]
          description: Primary subject (for teacher registration)
        selectedStudents:
          type: array
          items:
            type: integer
          description: Array of student IDs (for teacher registration)
      required:
        - username
        - password
        - role

    LoginRequest:
      type: object
      properties:
        username:
          type: string
          description: Username
        password:
          type: string
          description: Password
      required:
        - username
        - password

    ChatMessage:
      type: object
      properties:
        message:
          type: string
          description: User's message to the chatbot
        user_id:
          type: integer
          description: ID of the user sending the message
        session_id:
          type: integer
          description: Optional chat session ID
      required:
        - message
        - user_id

    ChatResponse:
      type: object
      properties:
        success:
          type: boolean
        response:
          type: string
          description: Chatbot's response
        timestamp:
          type: string
          format: date-time
        session_id:
          type: integer
          description: Chat session ID


    Transaction:
      type: object
      properties:
        id:
          type: integer
        amount:
          type: number
          format: float
        type:
          type: string
          enum: [income, expense]
        description:
          type: string
        date:
          type: string
          format: date-time
        user_id:
          type: integer

    SavingGoal:
      type: object
      properties:
        id:
          type: integer
        label:
          type: string
        target_amount:
          type: number
          format: float
        current_amount:
          type: number
          format: float
        user_id:
          type: integer

    Task:
      type: object
      properties:
        id:
          type: integer
        subject:
          type: string
        task:
          type: string
        due_date:
          type: string
          format: date
        status:
          type: string
          enum: [pending, in-progress, completed]
        created_at:
          type: string
          format: date-time
        time_spent:
          type: integer
          description: Time spent in minutes

    HealthTask:
      type: object
      properties:
        id:
          type: integer
        name:
          type: string
        completed:
          type: boolean

    PomodoroSession:
      type: object
      properties:
        id:
          type: integer
        user_id:
          type: integer
        homework_id:
          type: integer
        start_time:
          type: string
          format: date-time
        end_time:
          type: string
          format: date-time
        work_duration:
          type: integer
          description: Work duration in seconds
        break_duration:
          type: integer
          description: Break duration in seconds
        completed:
          type: boolean

    Drawing:
      type: object
      properties:
        id:
          type: integer
        description:
          type: string
        timestamp:
          type: string
          format: date-time
        file_path:
          type: string
        time_taken:
          type: integer
        ref_image_title:
          type: string

    ApiResponse:
      type: object
      properties:
        success:
          type: boolean
        message:
          type: string
        error:
          type: string

    Achievement:
      type: object
      properties:
        id:
          type: integer
        badge_name:
          type: string
        description:
          type: string
        date_awarded:
          type: string
          format: date-time
        badge_type:
          type: string
        icon:
          type: string

    DashboardStats:
      type: object
      properties:
        totalStars:
          type: integer
        questsCompleted:
          type: integer
        skillsLearned:
          type: integer
        todayGoals:
          type: integer
        streakDays:
          type: integer
        userLevel:
          type: integer

paths:
  # Authentication Endpoints
  /api/auth/register:
    post:
      summary: Register a new user
      description: Register a new user (child, parent, or teacher) in the system
      tags:
        - Authentication
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RegisterRequest'
            examples:
              child_registration:
                summary: Child Registration
                value:
                  username: "johnny_quest"
                  password: "secret123"
                  email: "johnny@example.com"
                  role: "child"
              parent_registration:
                summary: Parent Registration
                value:
                  username: "parent_user"
                  password: "parent123"
                  email: "parent@example.com"
                  role: "parent"
                  relationship_type: "Mother"
                  child_username: "johnny_quest"
              teacher_registration:
                summary: Teacher Registration
                value:
                  username: "teacher_smith"
                  password: "teach123"
                  email: "teacher@school.edu"
                  role: "teacher"
                  className: "Grade 5A"
                  primarySubject: "Mathematics"
                  selectedStudents: [1, 2, 3]
      responses:
        '201':
          description: User registered successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: true
                  message:
                    type: string
                    example: "User registered successfully"
                  user:
                    $ref: '#/components/schemas/User'
        '400':
          description: Missing required fields or invalid data
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false  # Changed from true to false
                  error:
                    type: string
                    example: "Missing required fields"
                required:
                  - success
                  - error
              examples:
                missing_fields:
                  summary: Missing required fields
                  value:
                    success: false
                    error: "Missing required fields"
                invalid_email:
                  summary: Invalid email format
                  value:
                    success: false
                    error: "Invalid email address"
        '409':
          description: Username or email already exists
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false  # Changed from true to false
                  error:
                    type: string
                    example: "Username already exists"
                required:
                  - success
                  - error
              examples:
                username_exists:
                  summary: Username already exists
                  value:
                    success: false
                    error: "Username already exists"
                email_exists:
                  summary: Email already exists
                  value:
                    success: false
                    error: "Email already exists"

  /api/auth/login:
    post:
      summary: User login
      description: Authenticate user and create session
      tags:
        - Authentication
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/LoginRequest'
            example:
              username: "johnny_quest"
              password: "secret123"
      responses:
        '200':
          description: Login successful
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                  user:
                    $ref: '#/components/schemas/User'
        '400':
          description: Missing username or password
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false  # Changed from true to false
                  error:
                    type: string
                    example: "Missing username or password"
                required:
                  - success
                  - error
        '401':
          description: Invalid credentials
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false  # Changed from true to false
                  error:
                    type: string
                    example: "Invalid credentials"
                required:
                  - success
                  - error

  # Chat/Emotional Support Endpoints
  /api/chat:
    post:
      summary: Send message to chatbot
      description: Send a message to the emotional support chatbot
      tags:
        - Chat & Emotional Support
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ChatMessage'
            example:
              message: "I'm feeling sad today"
              user_id: 1
              session_id: 123
      responses:
        '200':
          description: Chatbot response
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ChatResponse'
        '400':
          description: Message is required
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false  # Changed from true to false
                  error:
                    type: string
                    example: "Message is required"
                required:
                  - success
                  - error

  /api/chat/history/{user_id}:
    get:
      summary: Get chat history
      description: Retrieve chat history for a specific user
      tags:
        - Chat & Emotional Support
      parameters:
        - name: user_id
          in: path
          required: true
          schema:
            type: integer
          description: User ID
      responses:
        '200':
          description: Chat history retrieved
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  messages:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                        message:
                          type: string
                        sender:
                          type: string
                          enum: [user, assistant]
                        timestamp:
                          type: string
                          format: date-time
                        session_id:
                          type: integer
                          
                          
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  error:
                    type: string
                    example: "Internal server error"
                required:
                  - success
                  - error        

  /api/chat/sessions/{user_id}:
    get:
      summary: Get chat sessions
      description: Get all chat sessions for a user
      tags:
        - Chat & Emotional Support
      parameters:
        - name: user_id
          in: path
          required: true
          schema:
            type: integer
          description: User ID
      responses:
        '200':
          description: Chat sessions retrieved
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  sessions:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: integer
                        updated_at:
                          type: string
                          format: date-time
                        interaction_count:
                          type: integer
                        last_message_preview:
                          type: string
                        mood_tag:
                          type: string
                          
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  error:
                    type: string
                    example: "Internal server error"
                required:
                  - success
                  - error   

  # Finance Tracker Endpoints
  /api/finance/transactions/{user_id}:
    get:
      summary: Get user transactions
      description: Retrieve all financial transactions for a user
      tags:
        - Finance Tracker
      parameters:
        - name: user_id
          in: path
          required: true
          schema:
            type: integer
          description: User ID
      responses:
        '200':
          description: Transactions retrieved
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  transactions:
                    type: array
                    items:
                      $ref: '#/components/schemas/Transaction'
                      
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  error:
                    type: string
                    example: "Internal server error"
                required:
                  - success
                  - error

  /api/finance/transaction:
    post:
      summary: Add transaction
      description: Add a new financial transaction
      tags:
        - Finance Tracker
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                user_id:
                  type: integer
                amount:
                  type: number
                  format: float
                type:
                  type: string
                  enum: [income, expense]
                description:
                  type: string
              required:
                - user_id
                - amount
                - type
                - description
            example:
              user_id: 1
              amount: 25.50
              type: "income"
              description: "Allowance money"
      responses:
        '201':
          description: Transaction added successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  transaction:
                    $ref: '#/components/schemas/Transaction'
                    
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  error:
                    type: string
                    example: "Internal server error"
                required:
                  - success
                  - error

  /api/finance/goals/{user_id}:
    get:
      summary: Get savings goals
      description: Retrieve all savings goals for a user
      tags:
        - Finance Tracker
      parameters:
        - name: user_id
          in: path
          required: true
          schema:
            type: integer
          description: User ID
      responses:
        '200':
          description: Savings goals retrieved
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  goals:
                    type: array
                    items:
                      $ref: '#/components/schemas/SavingGoal'
                      
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  error:
                    type: string
                    example: "Internal server error"
                required:
                  - success
                  - error

  /api/finance/goal:
    post:
      summary: Add savings goal
      description: Create a new savings goal
      tags:
        - Finance Tracker
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                user_id:
                  type: integer
                label:
                  type: string
                target_amount:
                  type: number
                  format: float
              required:
                - user_id
                - label
                - target_amount
            example:
              user_id: 1
              label: "New Bike"
              target_amount: 150.00
      responses:
        '201':
          description: Savings goal created
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  goal:
                    $ref: '#/components/schemas/SavingGoal'
                    
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  error:
                    type: string
                    example: "Internal server error"
                required:
                  - success
                  - error

  # Task Management Endpoints
  /api/tasks/{user_id}:
    get:
      summary: Get user tasks
      description: Retrieve all tasks/homework for a user
      tags:
        - Task Management
      parameters:
        - name: user_id
          in: path
          required: true
          schema:
            type: integer
          description: User ID
      responses:
        '200':
          description: Tasks retrieved
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  tasks:
                    type: array
                    items:
                      allOf:
                        - $ref: '#/components/schemas/Task'
                        - type: object
                          properties:
                            session_stats:
                              type: object
                              properties:
                                total_sessions:
                                  type: integer
                                completed_sessions:
                                  type: integer
                                incomplete_sessions:
                                  type: integer
                                total_work_time:
                                  type: integer
                                  description: Total work time in minutes
                                total_break_time:
                                  type: integer
                                  description: Total break time in minutes
                                  
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  error:
                    type: string
                    example: "Internal server error"
                required:
                  - success
                  - error

  /api/tasks:
    post:
      summary: Create task
      description: Create a new task/homework assignment
      tags:
        - Task Management
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                user_id:
                  type: integer
                subject:
                  type: string
                task:
                  type: string
                due_date:
                  type: string
                  format: date
              required:
                - user_id
                - task
            example:
              user_id: 1
              subject: "Mathematics"
              task: "Complete chapter 5 exercises"
              due_date: "2025-07-20"
      responses:
        '201':
          description: Task created successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                  task:
                    $ref: '#/components/schemas/Task'
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  error:
                    type: string
                    example: "Internal server error"
                required:
                  - success
                  - error

  /api/tasks/{task_id}/status:
    put:
      summary: Update task status
      description: Update the status of a specific task
      tags:
        - Task Management
      parameters:
        - name: task_id
          in: path
          required: true
          schema:
            type: integer
          description: Task ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                status:
                  type: string
                  enum: [pending, in-progress, completed]
              required:
                - status
            example:
              status: "completed"
      responses:
        '200':
          description: Task status updated
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
        '404':
          description: Task not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ApiResponse'
        
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  error:
                    type: string
                    example: "Internal server error"
                required:
                  - success
                  - error

  # Pomodoro Timer Endpoints
  /api/pomodoro/start:
    post:
      summary: Start Pomodoro session
      description: Start a new Pomodoro study session for a task
      tags:
        - Pomodoro Timer
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                user_id:
                  type: integer
                homework_id:
                  type: integer
              required:
                - user_id
                - homework_id
            example:
              user_id: 1
              homework_id: 5
      responses:
        '201':
          description: Pomodoro session started
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  session_id:
                    type: integer
                    
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  error:
                    type: string
                    example: "Internal server error"
                required:
                  - success
                  - error

  /api/pomodoro/complete/{session_id}:
    put:
      summary: Complete Pomodoro session
      description: Mark a Pomodoro session as completed
      tags:
        - Pomodoro Timer
      parameters:
        - name: session_id
          in: path
          required: true
          schema:
            type: integer
          description: Session ID
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                work_duration:
                  type: integer
                  description: Work duration in seconds
                break_duration:
                  type: integer
                  description: Break duration in seconds
            example:
              work_duration: 1500
              break_duration: 300
      responses:
        '200':
          description: Session completed
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                    
        '404':
          description: Session not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  error:
                    type: string
                    example: "Session not found"
                required:
                  - success
                  - error
        
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  error:
                    type: string
                    example: "Internal server error"
                required:
                  - success
                  - error

  /api/pomodoro/pause/{session_id}:
    put:
      summary: Pause Pomodoro session
      description: Pause a running Pomodoro session
      tags:
        - Pomodoro Timer
      parameters:
        - name: session_id
          in: path
          required: true
          schema:
            type: integer
          description: Session ID
      responses:
        '200':
          description: Session paused
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                    
        '404':
          description: Session not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  error:
                    type: string
                    example: "Session not found"
                required:
                  - success
                  - error
                    
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  error:
                    type: string
                    example: "Internal server error"
                required:
                  - success
                  - error

  /api/pomodoro/resume/{session_id}:
    put:
      summary: Resume Pomodoro session
      description: Resume a paused Pomodoro session
      tags:
        - Pomodoro Timer
      parameters:
        - name: session_id
          in: path
          required: true
          schema:
            type: integer
          description: Session ID
      responses:
        '200':
          description: Session resumed
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                    
        '404':
          description: Session not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  error:
                    type: string
                    example: "Session not found"
                required:
                  - success
                  - error
                    
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  error:
                    type: string
                    example: "Internal server error"
                required:
                  - success
                  - error

  /api/pomodoro/abandon/{session_id}:
    put:
      summary: Abandon Pomodoro session
      description: Abandon a Pomodoro session
      tags:
        - Pomodoro Timer
      parameters:
        - name: session_id
          in: path
          required: true
          schema:
            type: integer
          description: Session ID
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                work_duration:
                  type: integer
                  description: Work duration in seconds
                break_duration:
                  type: integer
                  description: Break duration in seconds
      responses:
        '200':
          description: Session abandoned
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                    
        '404':
          description: Session not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  error:
                    type: string
                    example: "Session not found"
                required:
                  - success
                  - error
                    
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  error:
                    type: string
                    example: "Internal server error"
                required:
                  - success
                  - error

  # Health Tracking Endpoints
  /api/health/tasks/{user_id}:
    get:
      summary: Get health tasks
      description: Get daily health tasks for a user
      tags:
        - Health Tracking
      parameters:
        - name: user_id
          in: path
          required: true
          schema:
            type: integer
          description: User ID
      responses:
        '200':
          description: Health tasks retrieved
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  tasks:
                    type: array
                    items:
                      $ref: '#/components/schemas/HealthTask'
                      
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  error:
                    type: string
                    example: "Internal server error"
                required:
                  - success
                  - error

  /api/health/tasks/{task_id}/toggle:
    post:
      summary: Toggle task completion
      description: Toggle the completion status of a health task
      tags:
        - Health Tracking
      parameters:
        - name: task_id
          in: path
          required: true
          schema:
            type: integer
          description: Task ID
      responses:
        '200':
          description: Task status toggled
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  completed:
                    type: boolean
                    
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  error:
                    type: string
                    example: "Internal server error"
                required:
                  - success
                  - error

  /api/health/water/{user_id}:
    get:
      summary: Get water intake
      description: Get today's water intake count for a user
      tags:
        - Health Tracking
      parameters:
        - name: user_id
          in: path
          required: true
          schema:
            type: integer
          description: User ID
      responses:
        '200':
          description: Water intake retrieved
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  count:
                    type: integer
                  
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  error:
                    type: string
                    example: "Internal server error"
                required:
                  - success
                  - error

    post:
      summary: Increment water intake
      description: Add one glass to today's water intake
      tags:
        - Health Tracking
      parameters:
        - name: user_id
          in: path
          required: true
          schema:
            type: integer
          description: User ID
      responses:
        '200':
          description: Water intake incremented
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  count:
                    type: integer
                    
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  error:
                    type: string
                    example: "Internal server error"
                required:
                  - success
                  - error

  /api/health/streak/{user_id}:
    get:
      summary: Get health streak
      description: Get the current health streak for a user
      tags:
        - Health Tracking
      parameters:
        - name: user_id
          in: path
          required: true
          schema:
            type: integer
          description: User ID
      responses:
        '200':
          description: Health streak retrieved
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  streak:
                    type: integer
        
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  error:
                    type: string
                    example: "Internal server error"
                required:
                  - success
                  - error

  /api/health/water/log/{user_id}:
    get:
      summary: Get water intake log
      description: Get the last 7 days of water intake history
      tags:
        - Health Tracking
      parameters:
        - name: user_id
          in: path
          required: true
          schema:
            type: integer
          description: User ID
      responses:
        '200':
          description: Water intake log retrieved
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  log:
                    type: array
                    items:
                      type: object
                      properties:
                        date:
                          type: string
                          description: Day abbreviation (Mon, Tue, etc.)
                        count:
                          type: integer
                          description: Number of glasses consumed
              
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  error:
                    type: string
                    example: "Internal server error"
                required:
                  - success
                  - error

  # Drawing/Creative Endpoints
  /api/drawings/save:
    post:
      summary: Save drawing
      description: Save a user's drawing to the system
      tags:
        - Creative Activities
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                user_id:
                  type: integer
                image_data:
                  type: string
                  description: Base64 encoded image data
                description:
                  type: string
                time_taken:
                  type: integer
                  description: Time spent drawing in seconds
                ref_image_path:
                  type: string
                  description: Path to reference image used
                ref_image_title:
                  type: string
                  description: Title of reference image
              required:
                - user_id
                - image_data
            example:
              user_id: 1
              image_data: "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAA..."
              description: "My beautiful house drawing"
              time_taken: 600
              ref_image_path: "/static/reference_images/house.png"
              ref_image_title: "House"
      responses:
        '200':
          description: Drawing saved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                  drawing_id:
                    type: integer
                  file_path:
                    type: string
                  file_size:
                    type: integer
                  time_taken:
                    type: integer
                  ref_image_title:
                    type: string
              
        '400':
          description: No image data provided
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  error:
                    type: string
                    example: "No image data provided"
                required:
                  - success
                  - error
        
        
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  error:
                    type: string
                    example: "Internal server error"
                required:
                  - success
                  - error

  /api/drawings/{user_id}:
    get:
      summary: Get user drawings
      description: Retrieve all drawings for a specific user
      tags:
        - Creative Activities
      parameters:
        - name: user_id
          in: path
          required: true
          schema:
            type: integer
          description: User ID
      responses:
        '200':
          description: Drawings retrieved
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  drawings:
                    type: array
                    items:
                      allOf:
                        - $ref: '#/components/schemas/Drawing'
                        - type: object
                          properties:
                            file_exists:
                              type: boolean
                              description: Whether the file exists on disk
                            is_completed:
                              type: boolean
                              description: Whether the drawing session was completed
                            ref_image_path:
                              type: string
                              description: Path to reference image used
                          
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  error:
                    type: string
                    example: "Internal server error"
                required:
                  - success
                  - error

  /api/drawings/reference-images:
    get:
      summary: Get reference images
      description: Get available reference images for drawing inspiration
      tags:
        - Creative Activities
      responses:
        '200':
          description: Reference images retrieved
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  images:
                    type: array
                    items:
                      type: object
                      properties:
                        path:
                          type: string
                        filename:
                          type: string
                        title:
                          type: string
                        url:
                          type: string
                          
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  error:
                    type: string
                    example: "Internal server error"
                required:
                  - success
                  - error

  /api/drawings/random-reference:
    get:
      summary: Get random reference image
      description: Get a random reference image for drawing inspiration
      tags:
        - Creative Activities
      responses:
        '200':
          description: Random reference image retrieved
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  reference:
                    type: object
                    properties:
                      path:
                        type: string
                      filename:
                        type: string
                      title:
                        type: string
                      url:
                        type: string
          
        '404':
          description: No reference images available
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  error:
                    type: string
                    example: "No reference images available"
                required:
                  - success
                  - error

        
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  error:
                    type: string
                    example: "Internal server error"
                required:
                  - success
                  - error

  /api/drawings/start-session:
    post:
      summary: Start drawing session
      description: Start a new drawing session with timer
      tags:
        - Creative Activities
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                user_id:
                  type: integer
                ref_image_path:
                  type: string
                ref_image_title:
                  type: string
            example:
              user_id: 1
              ref_image_path: "/static/reference_images/house.png"
              ref_image_title: "House"
      responses:
        '201':
          description: Drawing session started
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  session_id:
                    type: integer
                  start_time:
                    type: string
                    format: date-time
                  ref_image_title:
                    type: string
                
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  error:
                    type: string
                    example: "Internal server error"
                required:
                  - success
                  - error

  /api/drawings/image/{drawing_id}:
    get:
      summary: Get drawing image
      description: Get a specific drawing image as base64
      tags:
        - Creative Activities
      parameters:
        - name: drawing_id
          in: path
          required: true
          schema:
            type: integer
          description: Drawing ID
      responses:
        '200':
          description: Drawing image retrieved
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  image_data:
                    type: string
                    description: Base64 encoded image data
                  description:
                    type: string
                  timestamp:
                    type: string
                    format: date-time
                    
        '404':
          description: Resource not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  error:
                    type: string
                    example: "Resource not found"
                required:
                  - success
                  - error
              examples:
                drawing_not_found:
                  summary: Drawing not found
                  value:
                    success: false
                    error: "Drawing not found"
                image_file_not_found:
                  summary: Image file not found
                  value:
                    success: false
                    error: "Image file not found"
        
        
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  error:
                    type: string
                    example: "Internal server error"
                required:
                  - success
                  - error

  /api/drawings/delete/{drawing_id}:
    delete:
      summary: Delete drawing
      description: Delete a drawing from both database and file system
      tags:
        - Creative Activities
      parameters:
        - name: drawing_id
          in: path
          required: true
          schema:
            type: integer
          description: Drawing ID
      responses:
        '200':
          description: Drawing deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                    
        '404':
          description: Drawing not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  error:
                    type: string
                    example: "Drawing not found"
                required:
                  - success
                  - error

        
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  error:
                    type: string
                    example: "Internal server error"
                required:
                  - success
                  - error


  # Psychometric Testing Endpoints
  /api/psychometry/start:
    post:
      summary: Start psychometric test
      description: Initialize a new psychometric assessment session
      tags:
        - Psychometric Testing
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                user_id:
                  type: integer
              required:
                - user_id
            example:
              user_id: 1
      responses:
        '200':
          description: Test started, first question returned
          content:
            application/json:
              schema:
                type: object
                properties:
                  question:
                    type: string
                  options:
                    type: array
                    items:
                      type: string
                  correct_answer:
                    type: string
                  category:
                    type: string
                  question_number:
                    type: integer
                  total_questions:
                    type: integer
                  progress:
                    type: number
                    format: float
                    
        '400':
          description: User ID is required
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  error:
                    type: string
                    example: "user_id is required"
                required:
                  - success
                  - error

        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  error:
                    type: string
                    example: "Internal server error"
                required:
                  - success
                  - error

  /api/psychometry/submit:
    post:
      summary: Submit psychometric answer
      description: Submit an answer for the current psychometric question
      tags:
        - Psychometric Testing
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                user_id:
                  type: integer
                answer:
                  type: string
              required:
                - user_id
                - answer
            example:
              user_id: 1
              answer: "A"
      responses:
        '200':
          description: Answer submitted, next question or results returned
          content:
            application/json:
              schema:
                oneOf:
                  - type: object
                    properties:
                      question:
                        type: string
                      options:
                        type: array
                        items:
                          type: string
                      correct_answer:
                        type: string
                      category:
                        type: string
                      question_number:
                        type: integer
                      total_questions:
                        type: integer
                      progress:
                        type: number
                        format: float
                  - type: object
                    properties:
                      results:
                        type: object
                        properties:
                          learning_style:
                            type: string
                          personality_type:
                            type: string
                          top_interest:
                            type: string
                          concentration_level:
                            type: number
                          memory_strength:
                            type: number
                          detailed_scores:
                            type: object
                          personality_breakdown:
                            type: object
                          feedback:
                            type: string
                      responses:
                        type: array
                        items:
                          type: object
                      total_questions:
                        type: integer
                      total_correct:
                        type: integer
                      accuracy:
                        type: number
                        format: float
                      duration_seconds:
                        type: number
                        format: float
        
        '400':
          description: Invalid request data
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  error:
                    type: string
                    example: "Invalid request data"
                required:
                  - success
                  - error
              examples:
                no_data:
                  summary: No data received
                  value:
                    success: false
                    error: "No data received"
                user_mismatch:
                  summary: User ID mismatch or missing
                  value:
                    success: false
                    error: "User ID mismatch or missing"
                no_answer:
                  summary: No answer provided
                  value:
                    success: false
                    error: "No answer provided"
                invalid_question_index:
                  summary: Invalid question index
                  value:
                    success: false
                    error: "Invalid question index"
      
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  error:
                    type: string
                    example: "Internal server error"
                required:
                  - success
                  - error


  # Child Dashboard Endpoints
  /api/child/stats/{user_id}:
    get:
      summary: Get child statistics
      description: Get dashboard statistics for a child user
      tags:
        - Child Dashboard
      parameters:
        - name: user_id
          in: path
          required: true
          schema:
            type: integer
          description: User ID
      responses:
        '200':
          description: Child statistics retrieved
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  stats:
                    $ref: '#/components/schemas/DashboardStats'
        
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  error:
                    type: string
                    example: "Internal server error"
                required:
                  - success
                  - error

  /api/child/quests/{user_id}:
    get:
      summary: Get child quests
      description: Get today's quests/activities for a child
      tags:
        - Child Dashboard
      parameters:
        - name: user_id
          in: path
          required: true
          schema:
            type: integer
          description: User ID
      responses:
        '200':
          description: Child quests retrieved
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  quests:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: integer
                        title:
                          type: string
                        description:
                          type: string
                        icon:
                          type: string
                        stars:
                          type: integer
                        completed:
                          type: boolean
                          
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  error:
                    type: string
                    example: "Internal server error"
                required:
                  - success
                  - error

  /api/child/quest/{quest_id}/toggle:
    post:
      summary: Toggle quest completion
      description: Toggle quest completion status
      tags:
        - Child Dashboard
      parameters:
        - name: quest_id
          in: path
          required: true
          schema:
            type: integer
          description: Quest ID
      responses:
        '200':
          description: Quest status updated
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                  starsEarned:
                    type: integer

  # Achievement Management Endpoints
  /api/achievements/{user_id}:
    get:
      summary: Get user achievements
      description: Get all achievements for a user
      tags:
        - Achievements
      parameters:
        - name: user_id
          in: path
          required: true
          schema:
            type: integer
          description: User ID
      responses:
        '200':
          description: Achievements retrieved
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  achievements:
                    type: array
                    items:
                      $ref: '#/components/schemas/Achievement'
                      
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  error:
                    type: string
                    example: "Internal server error"
                required:
                  - success
                  - error

  /api/achievement:
    post:
      summary: Create achievement
      description: Create a new achievement for a user
      tags:
        - Achievements
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                user_id:
                  type: integer
                badge_name:
                  type: string
                description:
                  type: string
                badge_type:
                  type: string
                  default: "general"
                icon:
                  type: string
                  default: "🏆"
              required:
                - user_id
                - badge_name
            example:
              user_id: 1
              badge_name: "Math Master"
              description: "Completed 10 math exercises"
              badge_type: "academic"
              icon: "🧮"
      responses:
        '201':
          description: Achievement created
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                  achievement:
                    $ref: '#/components/schemas/Achievement'
                    
        '400':
          description: Missing required fields
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  error:
                    type: string
                    example: "user_id and badge_name are required"
                required:
                  - success
                  - error
                  
        '404':
          description: User not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  error:
                    type: string
                    example: "User not found"
                required:
                  - success
                  - error
                    
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  error:
                    type: string
                    example: "Internal server error"
                required:
                  - success
                  - error

  /api/achievement/test:
    post:
      summary: Create test achievement
      description: Create a test achievement for testing dashboard stats
      tags:
        - Achievements
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                user_id:
                  type: integer
                badge_name:
                  type: string
                description:
                  type: string
              required:
                - user_id
            example:
              user_id: 1
              badge_name: "Test Achievement"
              description: "This is a test achievement"
      responses:
        '201':
          description: Test achievement created
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                  achievement:
                    type: object
                    properties:
                      id:
                        type: integer
                      badge_name:
                        type: string
                      description:
                        type: string
                        
        '400':
          description: User ID is required
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  error:
                    type: string
                    example: "user_id is required"
                required:
                  - success
                  - error
                  
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  error:
                    type: string
                    example: "Internal server error"
                required:
                  - success
                  - error


  /api/activity/complete:
    post:
      summary: Complete activity
      description: Mark an activity as completed and create achievement
      tags:
        - Achievements
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                user_id:
                  type: integer
                activity_name:
                  type: string
                  description: Activity name like 'Memory Game', 'Music Player', etc.
              required:
                - user_id
                - activity_name
            example:
              user_id: 1
              activity_name: "Memory Game"
      responses:
        '200':
          description: Activity completed
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                  stars_earned:
                    type: integer
                  achievement_id:
                    type: integer
        
        '400':
          description: Missing required fields
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  error:
                    type: string
                    example: "user_id and activity_name are required"
                required:
                  - success
                  - error
        
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  error:
                    type: string
                    example: "Internal server error"
                required:
                  - success
                  - error


  # User Profile Endpoints
  /api/user/profile/{user_id}:
    get:
      summary: Get user profile
      description: Get profile information for a specific user
      tags:
        - User Management
      parameters:
        - name: user_id
          in: path
          required: true
          schema:
            type: integer
          description: User ID
      responses:
        '200':
          description: User profile retrieved
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  user:
                    $ref: '#/components/schemas/User'
        '404':
          description: User not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  error:
                    type: string
                    example: "User not found"
                required:
                  - success
                  - error
                  
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  error:
                    type: string
                    example: "Internal server error"
                required:
                  - success
                  - error

                

  # Module Progress Endpoints
  /api/module/progress:
    post:
      summary: Save module progress
      description: Save module progress for a user
      tags:
        - Module Progress
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                user_id:
                  type: integer
                module_type:
                  type: string
                progress_percentage:
                  type: number
                  format: float
                  minimum: 0
                  maximum: 100
                is_completed:
                  type: boolean
                  default: false
                progress_data:
                  type: object
                  description: Additional progress data
              required:
                - user_id
                - module_type
            example:
              user_id: 1
              module_type: "Math Practice"
              progress_percentage: 75.5
              is_completed: false
              progress_data:
                current_level: 3
                questions_answered: 15
                correct_answers: 12
      responses:
        '200':
          description: Progress saved successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                  progress_percentage:
                    type: number
                    format: float
        
        '400':
          description: Missing user_id
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  error:
                    type: string
                    example: "user_id is required"
                required:
                  - success
                  - error
          
        '404':
          description: User not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  error:
                    type: string
                    example: "User not found"
                required:
                  - success
                  - error
                  
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  error:
                    type: string
                    example: "Internal server error"
                required:
                  - success
                  - error



  /api/module/progress/{user_id}/{module_type}:
    get:
      summary: Get module progress
      description: Get module progress for a specific user and module
      tags:
        - Module Progress
      parameters:
        - name: user_id
          in: path
          required: true
          schema:
            type: integer
          description: User ID
        - name: module_type
          in: path
          required: true
          schema:
            type: string
          description: Module type (URL encoded)
      responses:
        '200':
          description: Module progress retrieved
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  progress:
                    type: object
                    properties:
                      progress_data:
                        type: object
                      last_updated:
                        type: string
                        format: date-time
                    nullable: true
                  message:
                    type: string
                    
        '404':
          description: Resource not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  error:
                    type: string
                    example: "Resource not found"
                required:
                  - success
                  - error
              examples:
                user_not_found:
                  summary: User not found
                  value:
                    success: false
                    error: "User not found"
                no_valid_progress_data:
                  summary: No valid progress data found
                  value:
                    success: false
                    error: "No valid progress data found"

        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  error:
                    type: string
                    example: "Internal server error"
                required:
                  - success
                  - error

  # Notification Endpoints
  /api/notifications/{user_id}:
    get:
      summary: Get notifications
      description: Get all notifications for a user
      tags:
        - Notifications
      parameters:
        - name: user_id
          in: path
          required: true
          schema:
            type: integer
          description: User ID
      responses:
        '200':
          description: Notifications retrieved
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  notifications:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: integer
                        content:
                          type: string
                        is_read:
                          type: boolean
                        timestamp:
                          type: string
                          format: date-time
                      
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  error:
                    type: string
                    example: "Internal server error"
                required:
                  - success
                  - error

  /api/notifications/mark-read:
    post:
      summary: Mark notifications as read
      description: Mark multiple notifications as read
      tags:
        - Notifications
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                notification_ids:
                  type: array
                  items:
                    type: integer
              required:
                - notification_ids
            example:
              notification_ids: [1, 2, 3]
      responses:
        '200':
          description: Notifications marked as read
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                    
        '400':
          description: Missing notification IDs
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  error:
                    type: string
                    example: "notification_ids are required"
                required:
                  - success
                  - error

                    
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  error:
                    type: string
                    example: "Internal server error"
                required:
                  - success
                  - error

  /api/notifications/create-sample:
    post:
      summary: Create sample notifications
      description: Create sample notifications for testing (development only)
      tags:
        - Notifications
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                user_id:
                  type: integer
              required:
                - user_id
            example:
              user_id: 1
      responses:
        '201':
          description: Sample notifications created
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
        
        '400':
          description: Missing user_id
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  error:
                    type: string
                    example: "user_id is required"
                required:
                  - success
                  - error

                    
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  error:
                    type: string
                    example: "Internal server error"
                required:
                  - success
                  - error

  # Utility Endpoints
  /api/quote/{user_id}:
    get:
      summary: Get motivational quote
      description: Get a daily motivational quote for a user
      tags:
        - Utility
      parameters:
        - name: user_id
          in: path
          required: true
          schema:
            type: integer
          description: User ID
      responses:
        '200':
          description: Motivational quote retrieved
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  quote:
                    type: string
                  
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  error:
                    type: string
                    example: "Internal server error"
                required:
                  - success
                  - error

  /api/login-streak/{user_id}:
    get:
      summary: Get login streak
      description: Get current login streak for a user
      tags:
        - Utility
      parameters:
        - name: user_id
          in: path
          required: true
          schema:
            type: integer
          description: User ID
      responses:
        '200':
          description: Login streak retrieved
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  current_streak:
                    type: integer
                  total_logins:
                    type: integer
                  longest_streak:
                    type: integer
                  last_login_date:
                    type: string
                    format: date
                    nullable: true
                    
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  error:
                    type: string
                    example: "Internal server error"
                required:
                  - success
                  - error

  /api/screen-time/log:
    post:
      summary: Log screen time
      description: Log screen time for a user
      tags:
        - Utility
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                user_id:
                  type: integer
                duration_seconds:
                  type: integer
                  description: Duration in seconds
              required:
                - user_id
                - duration_seconds
            example:
              user_id: 1
              duration_seconds: 3600
      responses:
        '200':
          description: Screen time logged
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
            
        '400':
          description: Missing required fields
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  error:
                    type: string
                    example: "user_id and duration_seconds are required"
                required:
                  - success
                  - error
        
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  error:
                    type: string
                    example: "Internal server error"
                required:
                  - success
                  - error


  /api/task-time/analytics/{user_id}:
    get:
      summary: Get task time analytics
      description: Get time analytics for a user's tasks
      tags:
        - Utility
      parameters:
        - name: user_id
          in: path
          required: true
          schema:
            type: integer
          description: User ID
        - name: homework_id
          in: query
          required: false
          schema:
            type: integer
          description: Optional homework ID to filter analytics
      responses:
        '200':
          description: Task time analytics retrieved
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  analytics:
                    type: object
                    properties:
                      total_work_time:
                        type: integer
                        description: Total work time in seconds
                      total_break_time:
                        type: integer
                        description: Total break time in seconds
                      session_stats:
                        type: object
                        properties:
                          total_sessions:
                            type: integer
                          completed_sessions:
                            type: integer
                          incomplete_sessions:
                            type: integer
                          average_work_time:
                            type: number
                            format: float
                          average_break_time:
                            type: number
                            format: float
                      recent_sessions:
                        type: array
                        items:
                          type: object
                          properties:
                            id:
                              type: integer
                            start_time:
                              type: string
                              format: date-time
                              nullable: true
                            end_time:
                              type: string
                              format: date-time
                              nullable: true
                            work_duration:
                              type: integer
                            break_duration:
                              type: integer
                            completed:
                              type: boolean
                              
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  error:
                    type: string
                    example: "Internal server error"
                required:
                  - success
                  - error

  # Legacy Endpoints
  /chatbot:
    post:
      summary: Legacy chatbot endpoint
      description: Legacy chatbot endpoint for backward compatibility
      tags:
        - Legacy
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                user_id:
                  type: integer
                user_message:
                  type: string
              required:
                - user_id
                - user_message
      responses:
        '200':
          description: Chatbot response
          content:
            application/json:
              schema:
                type: object
                properties:
                  response:
                    type: string
                  timestamp:
                    type: string
                    format: date-time
                  session_id:
                    type: integer
                  mood:
                    type: string
                    
        '400':
          description: Missing required fields
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "user_id and message are required"
                required:
                  - error
                    
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  error:
                    type: string
                    example: "Internal server error"
                required:
                  - success
                  - error

  /chat-history/{user_id}:
    get:
      summary: Legacy chat history
      description: Legacy route for chat history
      tags:
        - Legacy
      parameters:
        - name: user_id
          in: path
          required: true
          schema:
            type: integer
          description: User ID
      responses:
        '200':
          description: Chat history retrieved
          content:
            application/json:
              schema:
                type: object
                properties:
                  chat_history:
                    type: array
                    items:
                      type: object
                      properties:
                        id:
                          type: string
                        message:
                          type: string
                        sender:
                          type: string
                        timestamp:
                          type: string
                          format: date-time
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  error:
                    type: string
                    example: "Internal server error"
                required:
                  - success
                  - error

  /clear-chat/{user_id}:
    delete:
      summary: Clear chat history
      description: Clear all chat history for a user
      tags:
        - Legacy
      parameters:
        - name: user_id
          in: path
          required: true
          schema:
            type: integer
          description: User ID
      responses:
        '200':
          description: Chat history cleared
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                  
        '500':
          description: Internal server error
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                    example: false
                  error:
                    type: string
                    example: "Internal server error"
                required:
                  - success
                  - error

tags:
  - name: Authentication
    description: User registration and login endpoints
  - name: Chat & Emotional Support
    description: AI-powered emotional support chatbot with session management
  - name: Finance Tracker
    description: Financial literacy and money management tools
  - name: Task Management
    description: Homework and task tracking system
  - name: Pomodoro Timer
    description: Focus and productivity timer with session management
  - name: Health Tracking
    description: Physical wellness and habit tracking
  - name: Creative Activities
    description: Drawing and artistic expression tools
  - name: Psychometric Testing
    description: Learning style and personality assessment
  - name: Child Dashboard
    description: Child-specific dashboard and statistics
  - name: Achievements
    description: Achievement and badge system
  - name: User Management
    description: User profile and account management
  - name: Module Progress
    description: Educational module progress tracking
  - name: Notifications
    description: User notification system
  - name: Utility
    description: System utilities and helper endpoints
  - name: Legacy
    description: Legacy endpoints for backward compatibility
